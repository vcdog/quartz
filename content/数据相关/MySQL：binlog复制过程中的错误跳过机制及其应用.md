>MySQL是一种广泛使用的关系数据库管理系统，提供了强大的数据复制功能，以确保数据的可靠性和一致性。然而，在复制过程中可能会遇到某些错误，这些错误可能会中断复制进程，影响到系统的正常运行。为了应对这种情况，MySQL提供了一种机制，允许我们在从服务器上跳过特定的错误，从而保持复制的连续性。在本文中，我们将探讨这种机制，以及如何在实践中应用它。
>

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/56f24de59b6b4f46b3094542dc1b1649~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1080&h=707&s=97547&e=png&b=fefefe)

## 1. replica`_skip_errors`配置选项

在MySQL中，replica`_skip_errors`是一个可以配置的系统变量，它允许我们指定在复制过程中应该忽略哪些错误。你可以通过下面的命令查看该变量的当前值：

sql

 代码解读

复制代码

`SHOW VARIABLES LIKE 'replica_skip_errors';`

在你提供的示例中，replica`_skip_errors`的值设置为`1032,1062`1。这意味着，如果从服务器在复制过程中遇到错误码`1032`或`1062`，它将跳过这些错误，并继续复制进程。

## 2. 错误码的含义

- 错误码`1032`代表“无法找到记录”。
- 错误码`1062`代表“对于键是重复条目”。

这些错误可能是由于在主服务器上的数据与从服务器上的数据不一致所引起的。

## 3. 如何配置replica`_skip_errors`

如果你想在从服务器上配置`slave_skip_errors`以跳过特定的错误，你可以使用以下命令：

`SET GLOBAL replica_skip_errors = '1032,1062';`

此命令将全局设置replica`_skip_errors`变量，从而在复制过程中跳过错误码`1032`和`1062`。

## 4. 官方错误码文档

了解所有可能的MySQL错误码及其含义是非常重要的，这将帮助你更好地理解和解决可能遇到的问题。你可以在MySQL的官方文档中找到所有错误码的列表和描述：

## 5. 总结

`replica_skip_errors`是一个强大的工具，可以帮助我们在遇到复制错误时保持系统的运行。然而，过度使用这个选项可能会导致数据不一致，所以应该谨慎使用。在使用replica`_skip_errors`跳过错误之前，应该尽量理解错误的原因，并尝试解决根本问题。


### 设置replica_skip_errors跳过：


```mysql

-- 修改配置后，需要重启数据库实例才能生效，不支持动态修改
[root@wtj1vpztmysql02 ~]# grep replica_skip /etc/my_3306.cnf
#replica_skip_errors=1032,1062
#replica_skip_errors = ddl_exist_errors

# 1032,1062 + ddl_exist_errors
replica_skip_errors = '1007,1008,1050,1051,1054,1060,1061,1068,1091,1146,1032,1062'


mysql> set global replica_skip_errors='1007,1008,1050,1051,1054,1060,1061,1068,1091,1146,1032,1062';


mysql> SHOW VARIABLES LIKE 'replica_skip_errors';
+---------------------+-------------------------------------------------------------+
| Variable_name       | Value                                                       |
+---------------------+-------------------------------------------------------------+
| replica_skip_errors | 1007,1008,1032,1050,1051,1054,1060,1061,1062,1068,1091,1146 |
+---------------------+-------------------------------------------------------------+
1 row in set (0.00 sec)



```
### 表示的错误代码

你提供的输出显示了 `replica_skip_errors` 当前配置为忽略以下错误代码：

- **1007**: 错误 `ER_DB_CREATE_EXISTS`，指的是尝试创建的数据库已存在。
- **1008**: 错误 `ER_DB_DROP_EXISTS`，指的是尝试删除的数据库不存在。
- **1050**: 错误 `ER_TABLE_EXISTS_ERROR`，指的是尝试创建的表已存在。
- **1051**: 错误 `ER_BAD_TABLE_ERROR`，指的是尝试删除的表不存在。
- **1054**: 错误 `ER_BAD_FIELD_ERROR`，指的是在表中找不到列。
- **1060**: 错误 `ER_DUP_FIELDNAME`，指的是尝试创建的列在表中已存在。
- **1061**: 错误 `ER_DUP_KEYNAME`，指的是尝试创建的键名已存在。
- **1068**: 错误 `ER_MULTIPLE_PRI_KEY`，指的是表中已经存在主键，无法创建多个主键。
- **1091**: 错误 `ER_CANT_DROP_FIELD_OR_KEY`，指的是尝试删除的列或索引不存在。
- **1146**: 错误 `ER_NO_SUCH_TABLE`，指的是尝试操作的表不存在。

### **1032**: `ER_KEY_NOT_FOUND`

- **描述**: 这是一个表示"键未找到"的错误。通常在复制过程中，当一个 `UPDATE` 或 `DELETE` 语句尝试在从库中修改或删除一行数据，但该行在从库中不存在时，就会发生此错误。
- **典型场景**:
    - **复制中的问题**：如果主库执行了某个事务，而从库由于某种原因丢失了部分数据，导致该事务在从库执行时找不到对应的行，就会引发 `1032` 错误。
    - **数据不同步**：如果主库和从库的数据没有完全同步，可能会导致从库执行更新或删除时找不到对应的键。

###  **1062**: `ER_DUP_ENTRY`

- **描述**: 这是一个表示"重复条目"的错误。它发生在尝试插入一条数据时，如果该数据在唯一索引中已经存在，则会产生此错误。
- **典型场景**:
    - **插入重复的唯一键**：如果你尝试在有唯一约束的列（如 `PRIMARY KEY` 或 `UNIQUE` 索引）中插入一个已经存在的值，就会引发 `1062` 错误。
    - **复制中的问题**：在 MySQL 复制过程中，如果从库在主库执行插入操作时尝试插入已经存在的数据行（可能由于之前的数据不一致或重复操作），也会触发 `1062` 错误。
  